<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>Daily Activity Tracker</title>

  <!-- Eye-friendly Styles (unchanged) -->
  <style>
    :root {
      --bg: #f5f7fa;
      --card-bg: #ffffff;
      --primary: #007bff;
      --primary-hover: #0056b3;
      --text: #333333;
      --border: #d1d5da;
      --header-bg: #ffffff;
      --header-text: #0056b3;
      --table-header: #f0f0f0;
      --table-row-alt: #fafbfc;
    }
    body {
      margin:0; padding:0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: var(--bg); color: var(--text); line-height:1.6;
    }
    .header {
      background: var(--header-bg);
      color: var(--header-text);
      padding:1rem;
      display:flex; align-items:center; justify-content:space-between;
      box-shadow:0 2px 4px rgba(0,0,0,0.1);
    }
    .header h1 { margin:0; font-size:1.5rem; }
    /* Version note styling */
    #version-note {
      font-size:0.9rem;
      color: var(--text);
      margin-right: auto;
      margin-left: 1rem;
    }
    .header button {
      background: var(--primary);
      color:#fff;
      border:none;
      padding:0.3rem 0.6rem;
      border-radius:4px;
      cursor:pointer;
      transition: background 0.2s;
    }
    .header button:hover { background: var(--primary-hover); }

    /* (rest of styles unchanged, calendar, cards, controls, tables, toast…) */
    /* … */
  </style>
</head>
<body>
  <div class="header">
    <h1>Daily Activity Tracker</h1>
    <!-- Version note visible in the UI -->
    <span id="version-note">Version: 1.0.0</span>
    <button id="help-toggle" type="button">?</button>
  </div>

  <!-- (all your existing HTML: calendar controls, tables, buttons, etc.) -->
  <!-- … -->

  <script>
  document.addEventListener('DOMContentLoaded', () => {
    // === Version constant ===
    const VERSION = '1.0.0';
    // Display it in the UI
    document.getElementById('version-note').textContent = `Version: ${VERSION}`;

    // === Existing utility & calendar code ===
    function getToday() { /* … */ }
    function createCalendar(y, m) { /* … */ }
    function renderCalendars(y1, m1, y2, m2) { /* … */ }

    // === TaskManager class & all the logic ===
    class TaskManager { /* … */ }

    // === DOM refs & rendering functions ===
    const tm = new TaskManager(),
          // … grab your elements …

    function showToast(msg) { /* … */ }
    function renderCards(tasks) { /* … */ }
    function updateSelectedInfo(date, tasks) { /* … */ }
    function addSelect(tr, opts, val, onCh) { /* … */ }
    function addInput(tr, type, val='') { /* … */ }
    function addButton(tr, label, cb) { /* … */ }
    function renderTable(tasks) { /* … */ }
    function renderAllTasks() { /* … */ }
    function loadTasks() { /* … */ }
    function saveTasks() { /* … */ }

    // === Updated ExportBackup (with file picker) ===
    async function exportBackup() {
      const data = JSON.stringify(tm.getAll(), null, 2);
      const now  = new Date();
      const dd   = String(now.getDate()).padStart(2,'0');
      const mm   = String(now.getMonth()+1).padStart(2,'0');
      const yyyy = now.getFullYear();
      const fn   = `tasks-backup-${dd}.${mm}.${yyyy}.json`;

      if (window.showSaveFilePicker) {
        try {
          const handle = await window.showSaveFilePicker({
            suggestedName: fn,
            types: [{ description: 'JSON Files', accept: { 'application/json': ['.json'] } }]
          });
          const writable = await handle.createWritable();
          await writable.write(data);
          await writable.close();
          showToast('Exported!');
        } catch (err) {
          console.warn('Save cancelled or failed:', err);
        }
        return;
      }
      // fallback
      const blob = new Blob([data], { type: 'application/json' });
      const url  = URL.createObjectURL(blob);
      const a    = document.createElement('a');
      a.href = url; a.download = fn; a.click(); URL.revokeObjectURL(url);
    }

    function importBackup(file) { /* … */ }

    // === Event wiring ===
    document.getElementById('export-btn').addEventListener('click', exportBackup);
    // … all your other listeners …

    // === Init calendars & first load ===
    // … same as before …
    loadTasks();
  });
  </script>
</body>
</html>
